<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BattMo Julia bridge &mdash; BattMo  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="_static/sphinx_collapse.css" />
      <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />

  
    <link rel="shortcut icon" href="_static/battmologo.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/design-tabs.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Alkaline Membrane Electrolyser" href="publishedExamples/runElectrolyser.html" />
    <link rel="prev" title="Note on Octave Support" href="octave.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            BattMo
              <img src="_static/battmologo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="basicusage.html">Basic Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="basicusage.html#a-first-battmo-model">A First <strong>BattMo</strong> Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="basicusage.html#define-parameters">Define Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="basicusage.html#run-simulation">Run Simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="basicusage.html#show-the-dashboard">Show the Dashboard</a></li>
<li class="toctree-l3"><a class="reference internal" href="basicusage.html#explore-the-output">Explore the Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="basicusage.html#explore-the-grid">Explore the Grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="basicusage.html#explore-the-states">Explore the States</a></li>
<li class="toctree-l3"><a class="reference internal" href="basicusage.html#plot-a-result">Plot a Result</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="basicusage.html#change-control-parameters">Change Control Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="basicusage.html#change-structural-parameters">Change Structural Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="basicusage.html#change-material-parameters">Change Material Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="basicusage.html#notebooks">Notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="basicusage.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="intermediate.html">Intermediate usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intermediate.html#setup-a-p4d-model-using-mergejsonstructs">Setup a P4D Model using <code class="code docutils literal notranslate"><span class="pre">mergeJsonStructs</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="intermediate.html#define-parameters">Define Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="intermediate.html#run-simulation">Run Simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="intermediate.html#visualize-results">Visualize Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="intermediate.html#file-links-and-insertions-with-parsebattmojson">File links and insertions with <code class="code docutils literal notranslate"><span class="pre">parseBattmoJson</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">BattMo Model Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="json.html">JSON input specification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="json.html#simulation-schema">Simulation Schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="json.html#material-parameters">Material Parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="json.html#electrolyte">Electrolyte</a></li>
<li class="toctree-l3"><a class="reference internal" href="json.html#electrode">Electrode</a></li>
<li class="toctree-l3"><a class="reference internal" href="json.html#coating">Coating</a></li>
<li class="toctree-l3"><a class="reference internal" href="json.html#active-material">Active Material</a></li>
<li class="toctree-l3"><a class="reference internal" href="json.html#interface">Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="json.html#solid-diffusion">Solid Diffusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="json.html#full-solid-diffusion">Full Solid Diffusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="json.html#binder">Binder</a></li>
<li class="toctree-l3"><a class="reference internal" href="json.html#conducting-additive">Conducting Additive</a></li>
<li class="toctree-l3"><a class="reference internal" href="json.html#current-collector">Current Collector</a></li>
<li class="toctree-l3"><a class="reference internal" href="json.html#separator">Separator</a></li>
<li class="toctree-l3"><a class="reference internal" href="json.html#thermal-model">Thermal Model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="json.html#geometry-setup">Geometry Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="json.html#simulation-control-parameters">Simulation Control Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="json.html#time-stepping-parameters">Time Stepping Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="json.html#solver-parameters">Solver Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="json.html#output-parameters">Output Parameters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="geometryinput.html">Battery Geometries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="geometryinput.html#batterygeneratorp2d">BatteryGeneratorP2D</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometryinput.html#batterygeneratorp3d">BatteryGeneratorP3D</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometryinput.html#batterygeneratorp4d">BatteryGeneratorP4D</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometryinput.html#spiralbatterygenerator">SpiralBatteryGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometryinput.html#coincellbatterygenerator">CoinCellBatteryGenerator</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometryinput.html#batterygeneratormultilayerpouch">BatteryGeneratorMultilayerPouch</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="advancedtopics.html">Advanced Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modelinitialisation.html">The Battery Simulation Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modelinitialisation.html#initialisation-of-a-battery-simulation-model">Initialisation of a battery simulation model</a></li>
<li class="toctree-l3"><a class="reference internal" href="modelinitialisation.html#inspection-of-the-model">Inspection of the model</a></li>
<li class="toctree-l3"><a class="reference internal" href="modelinitialisation.html#computing-and-inspecting-some-standard-static-properties-of-the-model">Computing and inspecting some standard static properties of the model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="controlinput.html">Control models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="controlinput.html#json-input-control-interface">Json input control interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="controlinput.html#control-model-description">Control model description</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="soliddiffusion.html">Solid Diffusion Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="parsets.html">Parameter sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="units.html">Units</a><ul>
<li class="toctree-l3"><a class="reference internal" href="units.html#converting-units-in-battmo">Converting units in BattMo</a></li>
<li class="toctree-l3"><a class="reference internal" href="units.html#units-and-json-input">Units and JSON input</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="thermal.html">Thermal Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="optimisation.html">Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="optimisation.html#parameter-identification-example">Parameter identification example</a></li>
<li class="toctree-l3"><a class="reference internal" href="optimisation.html#optimization-example">Optimization example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="octave.html">Octave</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">BattMo Julia bridge</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#start-server">Start Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="#send-simulation-parameters">Send simulation parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-the-simulation">Run the simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#post-process-the-output">Post process the output</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="publishedExamples/runElectrolyser.html">Electrolyser simulation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="publishedExamples/runElectrolyser.html#load-mrst-modules">Load MRST modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="publishedExamples/runElectrolyser.html#setup-input">Setup input</a></li>
<li class="toctree-l2"><a class="reference internal" href="publishedExamples/runElectrolyser.html#setup-model">Setup model</a></li>
<li class="toctree-l2"><a class="reference internal" href="publishedExamples/runElectrolyser.html#setup-the-initial-condition">Setup the initial condition</a></li>
<li class="toctree-l2"><a class="reference internal" href="publishedExamples/runElectrolyser.html#setup-the-schedule-with-the-time-discretization">Setup the schedule with the time discretization</a></li>
<li class="toctree-l2"><a class="reference internal" href="publishedExamples/runElectrolyser.html#setup-the-non-linear-solver">Setup the non-linear solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="publishedExamples/runElectrolyser.html#run-the-simulation">Run the simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="publishedExamples/runElectrolyser.html#visualize-the-results">Visualize the results</a></li>
<li class="toctree-l2"><a class="reference internal" href="publishedExamples/runElectrolyser.html#ph-distribution-plot">pH distribution plot</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gui.html">BattMo App</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gui_features.html">Features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="gui_features.html#use-default-materials">Use default materials</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_features.html#define-your-own-materials">Define your own materials</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_features.html#visualize-your-geometry">Visualize your geometry</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_features.html#download-your-input-data">Download your input data</a></li>
<li class="toctree-l3"><a class="reference internal" href="gui_features.html#visualize-and-download-your-results">Visualize and download your results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gui_calculations.html">Calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui_troubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="gui_troubleshooting.html#unnatural-artifacts-in-your-results">Unnatural artifacts in your results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="seealso.html">See Also</a><ul>
<li class="toctree-l2"><a class="reference internal" href="seealso.html#mrst">MRST</a><ul>
<li class="toctree-l3"><a class="reference internal" href="seealso.html#visualization">Visualization Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="seealso.html#id2">Grid Factory Tutorial</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="seealso.html#fair-data">FAIR Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">BattMo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">BattMo Julia bridge</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/juliabridge.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="battmo-julia-bridge">
<h1>BattMo Julia bridge<a class="headerlink" href="#battmo-julia-bridge" title="Permalink to this heading"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h2>
<p><strong>BattMo</strong> has a julia implementation for the standard PXD model: <strong>BattMo.jl</strong>. This package is registered in the General
Julia registry and available from <a class="reference external" href="https://github.com/BattMoTeam/BattMo.jl">github</a> . For small problems, the
simulator implemented in Julia is <em>significantly</em> faster than the matlab solver (several order of magnitude of
speed-up). The reason is that the assembly of the residual equations and their derivatives can be optimized in completly
different ways in a compiled code such as Julia. Our julia implementation relies on the package <a class="reference external" href="https://github.com/sintefmath/Jutul.jl">Jutul</a>.</p>
<p>We have implemented in matlab a <em>Julia Bridge</em> which provides a set of functionalities to run the julia solver and
retrieve the results directly from within matlab. The Julia Bridge uses julia package management system to install
BattMo.jl without further user intervention.</p>
</section>
<section id="start-server">
<h2>Start Server<a class="headerlink" href="#start-server" title="Permalink to this heading"></a></h2>
<p>To run simulation with Julia, we use a server. To communicate with the server we create a server manager from Matlab</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">man</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ServerManager</span><span class="p">();</span>
</pre></div>
</div>
<p>This command starts the Julia server and return a manager <code class="code docutils literal notranslate"><span class="pre">man</span></code> which we use to pass data and run simulations.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Julia uses <em>just-in-time</em> compilation. It means that when we run a function for the first time in a julia session,
the code is going to be compiled. The compilation may take time (more than 10s). When using Julia Bridge, you will
notice it at the start.</p>
<p>But, <strong>by starting a Julia server in the background</strong> where the compilation is done only once, Julia
Bridge makes it possible to use the <strong>BattMo</strong> julia solver at expected speed.</p>
<p>It is important to start the server only once and reuse it for further simulation, as described below</p>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>We could not start a persistent process from Matlab in Windows. The step must then be done manually, as follows</p>
<ul>
<li><p>Launch a command prompt window in Windows (NOT the powershell)</p></li>
<li><p>Run the following command:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">julia</span><span class="w"> </span><span class="o">--</span><span class="nb">startup</span><span class="o">-</span><span class="n">file</span><span class="p">=</span><span class="n">no</span><span class="w"> </span><span class="o">--</span><span class="n">project</span><span class="p">=</span><span class="o">\</span><span class="nb">path</span><span class="o">\</span><span class="n">to</span><span class="o">\</span><span class="n">RunMatlab</span><span class="o">\</span><span class="n">directory</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="s">&quot;using Revise, DaemonMode; serve(3000, true, call_stack=true, async=true)&quot;</span>
</pre></div>
</div>
<p>Replace <code class="code docutils literal notranslate"><span class="pre">/path/to/RunMatlab/directory</span></code> with the path to the
<a class="reference external" href="https://github.com/BattMoTeam/BattMo/blob/dev/Utilities/JuliaBridge/JuliaInterface/RunFromMatlab/">RunFromMatlab</a> directory, that is
<code class="code docutils literal notranslate"><span class="pre">Utilities\JuliaBridge\JuliaInterface\RunFromMatlab</span></code> if your current directory is BattMo root installation
directory.</p>
</li>
<li><p>Running this command will block the command prompt. The server will remain active until the window is closed or it
is deactivated in any other way. Calls to the server can now be made using the <code class="code docutils literal notranslate"><span class="pre">ServerManager</span></code> class.</p></li>
</ul>
</div>
</section>
<section id="send-simulation-parameters">
<h2>Send simulation parameters<a class="headerlink" href="#send-simulation-parameters" title="Permalink to this heading"></a></h2>
<p>We pass data to the server using the <code class="code docutils literal notranslate"><span class="pre">load</span></code> method.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">inputFileName</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fullfile</span><span class="p">(</span><span class="n">battmoDir</span><span class="p">(),</span><span class="w"> </span><span class="k">...</span>
<span class="w">                         </span><span class="s">&#39;Examples&#39;</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                         </span><span class="s">&#39;julia&#39;</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                         </span><span class="s">&#39;jsonfiles&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">                         </span><span class="s">&#39;p2d_40_jl_ud.json&#39;</span><span class="p">)</span>

<span class="n">man</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;inputType&#39;</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="s">&#39;JSON&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span>
<span class="w">         </span><span class="s">&#39;inputFileName&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">inputFileName</span><span class="p">);</span>
</pre></div>
</div>
<p>The <code class="code docutils literal notranslate"><span class="pre">inputType</span></code> can be either <code class="code docutils literal notranslate"><span class="pre">JSON</span></code> as in example above or <code class="code docutils literal notranslate"><span class="pre">Matlab</span></code>. For JSON input type, the input
is fully processed in julia but we only support for the moment 1D geometry in the Julia code. With the Matlab input
type, we can use any of the <a class="reference internal" href="geometryinput.html#battery-geometries"><span class="std std-ref">geometries</span></a> available in <strong>BattMo</strong> and pass it as
an input to the julia solver.</p>
<p>The json input <code class="code docutils literal notranslate"><span class="pre">p2d_40_jl_ud.json</span></code> contains functional parameters. For example, we have</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;Electrolyte&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="nt">&quot;ionicConductivity&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;function&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;function&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1e-4*c*((-10.5 + 0.668e-3*c + 0.494e-6*c^2) + (0.074 - 1.78e-5*c - 8.86e-10*c^2)*T + (-6.96e-5 + 2.80e-8*c)*T^2)^2&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;argumentlist&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="s2">&quot;c&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="s2">&quot;T&quot;</span><span class="p">]}}</span>
</pre></div>
</div>
<p>The full listing is available <a class="reference external" href="https://github.com/BattMoTeam/BattMo/blob/dev/Examples/JsonDataFiles/p2d_40_jl_ud.json">here</a>. For the <code class="code docutils literal notranslate"><span class="pre">function</span></code>
property, the string that is given to compute the corresponding value (ionic conductivity in the electrolyte in the
snippet above) should be written with a Julia syntax, as it is passed directly to the julia solver. This should not be a
big issue for Matlab users because the Julia syntax is very close to Matlab for such arithmetic expressions. We plan to
implement json support for tabulated data. Tabulated data give more flexibility and could be used both in Matlab and
Julia.</p>
</section>
<section id="run-the-simulation">
<h2>Run the simulation<a class="headerlink" href="#run-the-simulation" title="Permalink to this heading"></a></h2>
<p>Finally, we run the simulation</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">man</span><span class="p">.</span><span class="n">run</span><span class="p">();</span>
</pre></div>
</div>
</section>
<section id="post-process-the-output">
<h2>Post process the output<a class="headerlink" href="#post-process-the-output" title="Permalink to this heading"></a></h2>
<p>The matlab structure contains the simulation output, which can be processed in Matlab. For example,</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">voltage</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">cellfun</span><span class="p">(@(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">Phi</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="n">result</span><span class="p">.</span><span class="n">states</span><span class="p">.</span><span class="n">BPP</span><span class="p">});</span>
<span class="nb">time</span><span class="w">    </span><span class="p">=</span><span class="w"> </span><span class="nb">cumsum</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">extra</span><span class="p">.</span><span class="n">timesteps</span><span class="p">);</span>
<span class="nb">plot</span><span class="p">(</span><span class="nb">time</span><span class="o">/</span><span class="nb">hour</span><span class="p">,</span><span class="w"> </span><span class="n">voltage</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BattMo Julia&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">LineWidth</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="nb">legend</span>
<span class="nb">grid</span><span class="w"> </span><span class="n">on</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Time / h&#39;</span><span class="p">)</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Voltage / h&#39;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center">
<a class="reference external image-reference" href="_images/juliarun.png"><img alt="_images/juliarun.png" src="_images/juliarun.png" style="width: 70%;" /></a>
</figure>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="octave.html" class="btn btn-neutral float-left" title="Note on Octave Support" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="publishedExamples/runElectrolyser.html" class="btn btn-neutral float-right" title="Alkaline Membrane Electrolyser" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2023.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>