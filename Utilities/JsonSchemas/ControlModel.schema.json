{
  "$id": "file://./ControlModel.schema.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties" : {
    "Control" : {
      "type" : "object",
      "properties" : {
        "controlPolicy": {
          "type": "string",
          "enum": ["CCDischarge",
                   "CCCHarge",
                   "CCCV",
                   "powerControl"]}},
      "CRate" : {"type": "number"}
    },
    "allOf": [
      {"if": {
        "properties": {"controlPolicy" : {"const" : "CCDischarge"}},
        "then": {
          "$ref" : "#/$defs/CCDischarge"}}},
      {"if": {
        "properties": {"controlPolicy" : {"const" : "CCCharge"}},
        "then": {
          "$ref" : "#/$defs/CCCharge"}}},      
      {"if": {
        "properties": {"controlPolicy" : {"const" : "CCCV"}},
        "then":{
          "$ref" : "#/$defs/CCCV"}}},
      {"if": {
        "properties": {"controlPolicy" : {"const" : "CV"}},
        "then": {
          "$ref" : "#/$defs/CV"}}},
      {"if": {
        "properties": {"controlPolicy" : {"const" : "CC"}},
        "then": {
          "$ref" : "#/$defs/CC"}}},
      {"if": {
        "properties": {"controlPolicy" : {"const" : "powerControl"}},
        "then": {
          "$ref" : "#/$defs/power"}}}
    ]
  },

  "$defs" : {
    "CCDischarge" : {
      "properties" :
      {"rampupTime" : {
        "type" : "number",
        "description" : "rampup time"},
      "lowerCutoffVoltage" : {
        "type" : "number"},
       "useCVswitch" : {
         "type" : "boolean",
         "description" : "Switch to control voltage when the lower cutoff voltage is reached. Default value is false, which means that the simulation stops when the lower voltage is reached."
       }},
    "CCCharge" : {
      "properties" :
      {"rampupTime" : {
        "type" : "number",
        "description" : "rampup time"},
       "upperCutoffVoltage" : {
         "type" : "number"}
      }
    },
    "CCCV": {
      "properties" : {
        "dEdtLimit" : {"type" : "number"},
        "dIdtLimit" : {"type" : "number"},
        "numberOfCycles" : {"type" : "number"},
        "initialControl" : {"type" : "string",
                            "enum" : ["discharging", "charging"]}
      }},
    "CV": {
      "properties" : {
        "inputVoltage" : {"type" : "number"}}},
    "powerControl": {
      "properties" : {
        "case" : {"type" : "string",
                  "enum" : ["time limited", "voltage limited", "CPCV"]},
        "dischargingPower" : {"type" : "number"},
        "chargingPower" : {"type" : "number"}},
      
      "anyOf" : [
        { "properties" : {
          "powerControlCase" : {"const" : "time limited"},
          "dischargingTime" : {"type" : "number"},
          "chargingTime" : {"type" : "number"}
        }},
        
        { "properties" : {
          "powerControlCase" : {"const" : "voltage limited"}
        }},
        
        { "properties" : {
          "powerControlCase" : {"const" : "CPCV"},
          "lowerCutoffPower" : {"type" : "number"},
          "upperCutoffPower" : {"type" : "number"}
        }
        }
      ]}
  }
}
